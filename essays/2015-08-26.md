---
layout: essay
type: essay
title: Encrypted Key Exchange
date: 2015-11-11
labels:
  - Software Security
  - Learning
  - Password Security
---

Password based protocols are one of the most commonly encountered protocols. The base form is simple we have some session key R it can be sent to the server encrypted by some password assigned to the user. If the password P is a large random integer this can work fine although some more effort must go into the protocol if it is to be secure against attacks like a replay attack. However if P is weak then an attacker can easily gain access to the session key through brute force.

A dictionary attack on the protocol is very easy if the P created by the user is weak. By using one of the many lists he can repeatedly try values for P until it produces a session key that can decrypt some message sent by the client or server. This works because R is easy to confirm as you can see if for some Râ€™ you can obtain M from R(M). The EKE protocol discussed in a paper by Bellovin and Merrrit provides solutions while also fixing some other problems of the protocol
	
EKE solves the problem previously presented by adding a asymmetric key system in addition to the symmetric key system already employed. Instead of encrypting a session key the client encrypts a public key Ea with their password. The server will then return the session key encrypted by Ea and P. A series of challenges can also be added to prevent the previous mentioned replay attacks. EKE is secure even with a weak P because even if an attacker guesses P right he obtains Ea which he is unable to verify.
	
While the protocol is fairly simple implementing the public key system introduces some complexities. One such system for implanting EKE is using RSA. With an RSA cryptosystem the public key Ea consists of two values (e,n). This can lead to some difficulties as it we must encrypt two values as to be indistinguishable from a random number. One remedy to this is to send n unencrypted and to only encrypt e. RSA also opens up the protocol to a partition attack which is made possible since public key in RSA are always odd. While this reduction in key space is not immediately large enough to create vulnerability if an attacker eavesdrops on a number of these he can repeatedly partition the key space of P by excluding values that create illegal RSA keys.
	 
Another method of implementing EKE is through use of an exponential key exchange system. Using a Diffie-Hellman system with EKE one can both get around the complexities we encountered with RSA and solve some of the fundamental problems of a Diffie-Hellman system. The Diffie-Hellman protocol is weak to a man in the middle attack as due to the lack of mutual authentication an attacker could intercept messages from both A and B and compute a session key for both session such that A and B think they have a key they both know but instead they each have one known to them and the attacker. EKE encrypts the protocol with P so that an attacker cannot sit in the middle unless he knows P.  This allows EKE to achieve mutual authentication as a client now knows that the session key is only known to them and the server.
